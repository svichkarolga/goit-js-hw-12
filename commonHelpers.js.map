{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com/api';\n\nexport const fetchPhotos = async (searchedQuery, page) => {\n    try {\n        const axiosOptions = {\n            params: {\n                key: '45436198-db4764fd7ddf19e0d061d1cf8',\n                q: searchedQuery,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: 'true',\n                page: page,\n                per_page: 15,\n            }\n        };\n        return await axios.get('/', axiosOptions);\n    } catch (error) {\n        console.error('Error fetching images:', error);\n        throw error;\n    }\n};\n","export const createGalleryCardTemplate = (pictureInfo) => {\n    return ` <li class=\"gallery-card\">\n                <a class=\"gallery-link\" href=\"${pictureInfo.largeImageURL}\">\n                    <img class=\"gallery-img\"\n                    src=\"${pictureInfo.webformatURL}\" \n                    data-source=\"${pictureInfo.largeImageURL}\"\n                    alt=\"${pictureInfo.tags}\"\n                    />\n                </a>\n                <div class=\"wrapper\">\n                    <ul class=\"img-content-wrapper\">\n\t\t\t\t\t    <li class=\"text-info\">Likes<span class=\"number\">${pictureInfo.likes}</span></li>\n\t\t\t\t\t    <li class=\"text-info\">Views<span class=\"number\">${pictureInfo.views}</span></li>\n\t\t\t\t\t    <li class=\"text-info\">Comments<span class=\"number\">${pictureInfo.comments}</span></li>\n\t\t\t\t\t    <li class=\"text-info\">Downloads<span class=\"number\">${pictureInfo.downloads}</span></li>\n                    </ul>\n                </div>\n            </li>`\n\n};\n \n\n\n","import iziToast from \"izitoast\";\nimport { fetchPhotos } from \"./js/pixabay-api\";\nimport { createGalleryCardTemplate } from \"./js/render-functions\";\nimport SimpleLightbox from \"simplelightbox\";\n\n\nconst searchForm = document.querySelector(\".js-search-form\");\nconst galleryEl = document.querySelector('.js-gallery');\nconst loader = document.querySelector('.loader');\nconst btnLoadMore = document.querySelector('.js-load-more');\n\nlet currentPage = 1;\nlet searchedValue = '';\nlet cardHeight = 0;\n\nconst light = new SimpleLightbox('.js-gallery a', {\n    overlay: true,\n    captionsData: 'alt',\n    overlayOpacity: 0.8,\n    captionDelay: 250,\n    focus: true,\n});\n\nfunction showLoader() {\n    loader.classList.remove('is-hidden');\n};\nfunction hideLoader() {\n    loader.classList.add('is-hidden');\n};\n\nconst onSearch = async event => {\n    event.preventDefault();\n    showLoader();\n\n    searchedValue = searchForm.elements.user_query.value.trim();\n        \n    currentPage = 1; // значення поточної сторінки скидати в 0\n\n    try {\n        const response = await fetchPhotos(searchedValue, currentPage);\n        \n        if (searchedValue === \"\") {\n            iziToast.warning({\n                title: 'Caution',\n                message: 'Input field must not be empty',\n                position: 'topLeft',\n            });\n            return; // Перериваємо виконання функції, якщо поле порожнє\n        }\n        if (response.data.hits.length === 0) {\n            iziToast.error({\n                title: 'Error',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n                position: 'bottomRight',\n            });\n            galleryEl.innerHTML = '';\n            searchForm.reset();\n            return;\n        }\n        const galleryCardsTemplate = response.data.hits.map(imgDetails => createGalleryCardTemplate(imgDetails)).join('');\n        galleryEl.innerHTML = galleryCardsTemplate;\n        \n        // визначаємо вистоту карток для реалізації прокрутки\n        const galleryCardEl = galleryEl.querySelector('li');\n        console.log(galleryCardEl.getBoundingClientRect()); // дивимось розміри і розташевання карточки\n        cardHeight = galleryCardEl.getBoundingClientRect().height; // зиписуємо висоту каточки, яку попередньо в консолі побачили\n\n        btnLoadMore.classList.remove('is-hidden');\n        \n        light.refresh();\n\n        const totalPages = Math.ceil(response.data.totalHits / 15); // 15 - кількість зображень на сторінку\n        if (currentPage >= totalPages) {\n            btnLoadMore.classList.add('is-hidden');\n            iziToast.info({\n                title: 'Info',\n                message: 'We are sorry,but you have reached the end of search results',\n            });\n        }\n    }\n    catch (err) {\n        iziToast.error({\n            title: 'Error',\n            message: 'Illegal operation',\n        });\n    } finally {\n        hideLoader();\n    }\n    searchForm.reset();\n};\nsearchForm.addEventListener('submit', onSearch); \n\n// pagination==========================================================\nconst onLoadMoreBtn = async event => {\n    showLoader();\n    try {\n        currentPage++; \n        const response = await fetchPhotos(searchedValue, currentPage);\n        console.log(response);\n        const galleryCardsTemplate = response.data.hits.map(imgDetails => createGalleryCardTemplate(imgDetails)).join('');\n        galleryEl.insertAdjacentHTML('beforeend', galleryCardsTemplate);\n\n        // реалізуємо прокрутку\n        scrollBy({ \n            top: cardHeight * 2, // висоту карточки знайшли на 67 рядку\n            behavior: 'smooth',\n        });\n\n        light.refresh();\n\n        const totalPages = Math.ceil(response.data.totalHits / 15); // 15 - кількість зображень на сторінку\n        if (currentPage >= totalPages) {\n            btnLoadMore.classList.add('is-hidden');\n            iziToast.info({\n                title: 'Info',\n                message: 'We are sorry,but you have reached the end of search results',\n            });\n        }\n        searchForm.reset();\n\n    } catch (err) {\n        console.log(err);\n        iziToast.error({\n            message: \"Something went wrong. Please try again later.\",\n            position: 'topRight'\n        });\n    }   finally {\n        hideLoader();\n    }\n}\nbtnLoadMore.addEventListener('click', onLoadMoreBtn);\n\n\n\n\n\n\n   \n   \n\n\n\n\n\n\n"],"names":["axios","fetchPhotos","searchedQuery","page","axiosOptions","error","createGalleryCardTemplate","pictureInfo","searchForm","galleryEl","loader","btnLoadMore","currentPage","searchedValue","cardHeight","light","SimpleLightbox","showLoader","hideLoader","onSearch","event","response","iziToast","galleryCardsTemplate","imgDetails","galleryCardEl","totalPages","onLoadMoreBtn","err"],"mappings":"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"}